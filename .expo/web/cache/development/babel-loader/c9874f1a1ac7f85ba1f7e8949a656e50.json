{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/swalihvpm/Desktop/Projects/django_lms/rnlms/src/Helpers/AudioPlayer.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport * as React from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Constants from \"expo-constants\";\nimport { Button } from \"react-native-paper\";\nimport MaterialCommunityIcons from \"@expo/vector-icons/MaterialCommunityIcons\";\nimport { Audio } from \"expo-av\";\n\nvar _Dimensions$get = Dimensions.get(\"window\"),\n    width = _Dimensions$get.width,\n    height = _Dimensions$get.height;\n\nimport { useNavigation } from \"@react-navigation/native\";\nexport default function AudioPLayer(_ref) {\n  var Tracks = _ref.Tracks,\n      lessonId = _ref.lessonId,\n      hasQuiz = _ref.hasQuiz,\n      QuizId = _ref.QuizId,\n      unitId = _ref.unitId;\n  var navigation = useNavigation();\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      Loaded = _React$useState2[0],\n      SetLoaded = _React$useState2[1];\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      Loading = _React$useState4[0],\n      SetLoading = _React$useState4[1];\n\n  var _React$useState5 = React.useState(Tracks[0]),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      CurrentSong = _React$useState6[0],\n      SetCurrentSong = _React$useState6[1];\n\n  var _React$useState7 = React.useState(0),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      lastSongIndex = _React$useState8[0],\n      setLastSongIndex = _React$useState8[1];\n\n  var _React$useState9 = React.useState(false),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      isPlaying = _React$useState10[0],\n      SetIsPlaying = _React$useState10[1];\n\n  var _React$useState11 = React.useState(false),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      didJustFinish = _React$useState12[0],\n      setDidJustFinish = _React$useState12[1];\n\n  var sound = React.useRef(new Audio.Sound());\n\n  var onPlaybackStatusUpdate = function onPlaybackStatusUpdate(audio) {\n    if (audio) {\n      if (audio.didJustFinish) {\n        setDidJustFinish(true);\n      }\n    }\n  };\n\n  React.useEffect(function () {\n    LoadAudio();\n    find_last_track_index();\n    sound.current.setOnPlaybackStatusUpdate(onPlaybackStatusUpdate);\n    return function () {\n      return Unload();\n    };\n  }, [CurrentSong]);\n\n  var Unload = function Unload() {\n    return _regeneratorRuntime.async(function Unload$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(sound.current.unloadAsync());\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var find_last_track_index = function find_last_track_index() {\n    var track_length = Tracks.length;\n    setLastSongIndex(track_length - 1);\n  };\n\n  var PlayAudio = function PlayAudio() {\n    var result;\n    return _regeneratorRuntime.async(function PlayAudio$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(sound.current.getStatusAsync());\n\n          case 3:\n            result = _context2.sent;\n\n            if (result.isLoaded) {\n              if (result.isPlaying === false) {\n                SetIsPlaying(true);\n                setDidJustFinish(false);\n                sound.current.playAsync();\n              }\n            }\n\n            _context2.next = 10;\n            break;\n\n          case 7:\n            _context2.prev = 7;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log(_context2.t0);\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 7]], Promise);\n  };\n\n  var PauseAudio = function PauseAudio() {\n    var result;\n    return _regeneratorRuntime.async(function PauseAudio$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(sound.current.getStatusAsync());\n\n          case 3:\n            result = _context3.sent;\n\n            if (result.isLoaded) {\n              if (result.isPlaying === true) {\n                sound.current.pauseAsync();\n                SetIsPlaying(false);\n              }\n            }\n\n            _context3.next = 10;\n            break;\n\n          case 7:\n            _context3.prev = 7;\n            _context3.t0 = _context3[\"catch\"](0);\n            console.log(_context3.t0);\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[0, 7]], Promise);\n  };\n\n  var LoadAudio = function LoadAudio() {\n    var checkLoading, result;\n    return _regeneratorRuntime.async(function LoadAudio$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            SetLoaded(false);\n            SetLoading(true);\n            _context4.next = 4;\n            return _regeneratorRuntime.awrap(sound.current.getStatusAsync());\n\n          case 4:\n            checkLoading = _context4.sent;\n\n            if (!(checkLoading.isLoaded === false)) {\n              _context4.next = 19;\n              break;\n            }\n\n            _context4.prev = 6;\n            _context4.next = 9;\n            return _regeneratorRuntime.awrap(sound.current.loadAsync({\n              uri: CurrentSong.audio\n            }));\n\n          case 9:\n            result = _context4.sent;\n\n            if (result.isLoaded === false) {\n              SetLoading(false);\n              console.log(\"Error in Loading Audio\");\n            } else {\n              SetLoading(false);\n              PlayAudio();\n              SetLoaded(true);\n            }\n\n            _context4.next = 17;\n            break;\n\n          case 13:\n            _context4.prev = 13;\n            _context4.t0 = _context4[\"catch\"](6);\n            console.log(_context4.t0);\n            SetLoading(false);\n\n          case 17:\n            _context4.next = 20;\n            break;\n\n          case 19:\n            SetLoading(false);\n\n          case 20:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[6, 13]], Promise);\n  };\n\n  var NextSong = function NextSong() {\n    var currentSongIndex = Tracks.indexOf(CurrentSong);\n    var lastSongIndex = Tracks.indexOf(Tracks[Tracks.length - 1]);\n\n    if (currentSongIndex === lastSongIndex) {\n      SetCurrentSong(Tracks[0]);\n    } else {\n      SetCurrentSong(Tracks[currentSongIndex + 1]);\n    }\n  };\n\n  var PrevSong = function PrevSong() {\n    var currentSongIndex = Tracks.indexOf(CurrentSong);\n    var lastSongIndex = Tracks.indexOf(Tracks[Tracks.length - 1]);\n\n    if (currentSongIndex === 0) {\n      SetCurrentSong(Tracks[Tracks.length - 1]);\n    } else {\n      SetCurrentSong(Tracks[lastSongIndex - 1]);\n    }\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }\n  }, Tracks.indexOf(CurrentSong)), React.createElement(View, {\n    style: styles.TopContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: styles.ImgWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 9\n    }\n  }, React.createElement(Image, {\n    style: styles.photo,\n    source: {\n      uri: CurrentSong.photo\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 11\n    }\n  }))), React.createElement(View, {\n    style: styles.BottomContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 7\n    }\n  }, React.createElement(MaterialCommunityIcons, {\n    name: \"arrow-left\",\n    style: {\n      fontSize: 50,\n      alignSelf: \"center\",\n      padding: 20\n    },\n    onPress: PrevSong,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 9\n    }\n  }), React.createElement(MaterialCommunityIcons, {\n    name: !isPlaying || didJustFinish ? \"play\" : \"pause\",\n    style: {\n      fontSize: 50,\n      alignSelf: \"center\",\n      padding: 20,\n      borderRadius: 50\n    },\n    onPress: isPlaying || didJustFinish === false ? function () {\n      return PlayAudio();\n    } : function () {\n      return PauseAudio();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 9\n    }\n  }), Tracks.indexOf(CurrentSong) === lastSongIndex & hasQuiz ? React.createElement(Button, {\n    mode: \"Outlined\",\n    onPress: function onPress() {\n      return navigation.navigate(\"Lesson Test\", {\n        QuizId: QuizId,\n        lessonId: lessonId,\n        unitId: unitId\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 11\n    }\n  }, \"Take a Quiz\") : React.createElement(MaterialCommunityIcons, {\n    name: \"arrow-right\",\n    style: {\n      fontSize: 50,\n      alignSelf: \"center\",\n      padding: 20\n    },\n    onPress: NextSong,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 11\n    }\n  })));\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"center\"\n  },\n  TopContainer: {\n    flex: 5\n  },\n  BottomContainer: {\n    flex: 1,\n    flexDirection: \"row\",\n    justifyContent: \"center\"\n  },\n  ImgWrapper: {\n    width: width * 0.95,\n    height: height * 0.9,\n    marginTop: 5\n  },\n  photo: {\n    width: \"100%\",\n    height: \"80%\",\n    borderRadius: 10\n  }\n});","map":{"version":3,"sources":["/Users/swalihvpm/Desktop/Projects/django_lms/rnlms/src/Helpers/AudioPlayer.js"],"names":["React","Constants","Button","MaterialCommunityIcons","Audio","Dimensions","get","width","height","useNavigation","AudioPLayer","Tracks","lessonId","hasQuiz","QuizId","unitId","navigation","useState","Loaded","SetLoaded","Loading","SetLoading","CurrentSong","SetCurrentSong","lastSongIndex","setLastSongIndex","isPlaying","SetIsPlaying","didJustFinish","setDidJustFinish","sound","useRef","Sound","onPlaybackStatusUpdate","audio","useEffect","LoadAudio","find_last_track_index","current","setOnPlaybackStatusUpdate","Unload","unloadAsync","track_length","length","PlayAudio","getStatusAsync","result","isLoaded","playAsync","console","log","PauseAudio","pauseAsync","checkLoading","loadAsync","uri","NextSong","currentSongIndex","indexOf","PrevSong","styles","container","TopContainer","ImgWrapper","photo","BottomContainer","fontSize","alignSelf","padding","borderRadius","navigate","StyleSheet","create","flex","justifyContent","flexDirection","marginTop"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport {\n  View,\n  StyleSheet,\n  ActivityIndicator,\n  Image,\n  Dimensions,\n  Text\n} from \"react-native\";\nimport Constants from \"expo-constants\";\nimport { Button } from \"react-native-paper\";\nimport MaterialCommunityIcons from \"react-native-vector-icons/MaterialCommunityIcons\";\nimport { Audio } from \"expo-av\";\nconst { width, height } = Dimensions.get(\"window\");\nimport { useNavigation } from \"@react-navigation/native\";\n\nexport default function AudioPLayer({\n  Tracks,\n  lessonId,\n  hasQuiz,\n  QuizId,\n  unitId\n}) {\n  const navigation = useNavigation();\n  // console.log(QuizId);\n  const [Loaded, SetLoaded] = React.useState(false);\n  const [Loading, SetLoading] = React.useState(false);\n  const [CurrentSong, SetCurrentSong] = React.useState(Tracks[0]);\n  const [lastSongIndex, setLastSongIndex] = React.useState(0);\n\n  const [isPlaying, SetIsPlaying] = React.useState(false);\n  const [didJustFinish, setDidJustFinish] = React.useState(false);\n\n  const sound = React.useRef(new Audio.Sound());\n\n  const onPlaybackStatusUpdate = audio => {\n    if (audio) {\n      if (audio.didJustFinish) {\n        setDidJustFinish(true);\n      }\n    }\n  };\n\n  React.useEffect(() => {\n    LoadAudio();\n    find_last_track_index();\n    sound.current.setOnPlaybackStatusUpdate(onPlaybackStatusUpdate);\n    return () => Unload();\n  }, [CurrentSong]);\n\n  const Unload = async () => {\n    await sound.current.unloadAsync();\n  };\n  const find_last_track_index = () => {\n    const track_length = Tracks.length;\n    setLastSongIndex(track_length - 1);\n  };\n\n  const PlayAudio = async () => {\n    try {\n      const result = await sound.current.getStatusAsync();\n      if (result.isLoaded) {\n        if (result.isPlaying === false) {\n          SetIsPlaying(true);\n          setDidJustFinish(false);\n          sound.current.playAsync();\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const PauseAudio = async () => {\n    try {\n      const result = await sound.current.getStatusAsync();\n      if (result.isLoaded) {\n        if (result.isPlaying === true) {\n          sound.current.pauseAsync();\n          SetIsPlaying(false);\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const LoadAudio = async () => {\n    SetLoaded(false);\n    SetLoading(true);\n    const checkLoading = await sound.current.getStatusAsync();\n    if (checkLoading.isLoaded === false) {\n      try {\n        const result = await sound.current.loadAsync({\n          uri: CurrentSong.audio\n        });\n        if (result.isLoaded === false) {\n          SetLoading(false);\n          console.log(\"Error in Loading Audio\");\n        } else {\n          SetLoading(false);\n          PlayAudio();\n          SetLoaded(true);\n        }\n      } catch (error) {\n        console.log(error);\n        SetLoading(false);\n      }\n    } else {\n      SetLoading(false);\n    }\n  };\n\n  const NextSong = () => {\n    const currentSongIndex = Tracks.indexOf(CurrentSong);\n    const lastSongIndex = Tracks.indexOf(Tracks[Tracks.length - 1]);\n    if (currentSongIndex === lastSongIndex) {\n      SetCurrentSong(Tracks[0]);\n    } else {\n      SetCurrentSong(Tracks[currentSongIndex + 1]);\n    }\n  };\n\n  const PrevSong = () => {\n    const currentSongIndex = Tracks.indexOf(CurrentSong);\n    const lastSongIndex = Tracks.indexOf(Tracks[Tracks.length - 1]);\n    if (currentSongIndex === 0) {\n      SetCurrentSong(Tracks[Tracks.length - 1]);\n    } else {\n      SetCurrentSong(Tracks[lastSongIndex - 1]);\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      <Text>{Tracks.indexOf(CurrentSong)}</Text>\n      {/* {Loading ? <ActivityIndicator size={\"small\"} color={\"red\"} /> : null} }\n      // <View style={styles.container}> */}\n      {/* <View style={styles.AudioPLayer}> */}\n      {/* {Loading === true ? (\n        <ActivityIndicator size={\"small\"} color={\"red\"} />\n      ) : null} */}\n\n      <View style={styles.TopContainer}>\n        <View style={styles.ImgWrapper}>\n          <Image style={styles.photo} source={{ uri: CurrentSong.photo }} />\n        </View>\n      </View>\n      <View style={styles.BottomContainer}>\n        <MaterialCommunityIcons\n          name=\"arrow-left\"\n          style={{\n            // color: COLORS.white,\n            fontSize: 50,\n            alignSelf: \"center\",\n            // backgroundColor: \"gray\",\n            padding: 20\n            // borderRadius: 50\n            // borderWidth: 1,\n            // borderColor: \"#34a8eb\"\n          }}\n          onPress={PrevSong}\n        />\n        <MaterialCommunityIcons\n          name={!isPlaying || didJustFinish ? \"play\" : \"pause\"}\n          style={{\n            // color: COLORS.white,\n            fontSize: 50,\n            alignSelf: \"center\",\n            // backgroundColor: \"gray\",\n            padding: 20,\n            borderRadius: 50\n            // borderWidth: 1,\n            // borderColor: \"#34a8eb\"\n          }}\n          onPress={\n            isPlaying || didJustFinish === false\n              ? () => PlayAudio()\n              : () => PauseAudio()\n          }\n        />\n        {(Tracks.indexOf(CurrentSong) === lastSongIndex) & hasQuiz ? (\n          <Button\n            mode=\"Outlined\"\n            onPress={() =>\n              navigation.navigate(\"Lesson Test\", {\n                QuizId: QuizId,\n                lessonId: lessonId,\n                unitId: unitId\n              })\n            }\n          >\n            Take a Quiz\n          </Button>\n        ) : (\n          <MaterialCommunityIcons\n            name=\"arrow-right\"\n            style={{\n              // color: COLORS.white,\n              fontSize: 50,\n              alignSelf: \"center\",\n              // backgroundColor: \"gray\",\n              padding: 20\n              // borderRadius: 50\n              // borderWidth: 1,\n              // borderColor: \"#34a8eb\"\n            }}\n            onPress={NextSong}\n          />\n        )}\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"center\"\n  },\n  TopContainer: {\n    flex: 5\n  },\n  BottomContainer: {\n    flex: 1,\n    flexDirection: \"row\",\n    justifyContent: \"center\"\n  },\n  ImgWrapper: {\n    width: width * 0.95,\n    height: height * 0.9,\n    marginTop: 5\n    // marginBottom: 25\n  },\n  photo: {\n    width: \"100%\",\n    height: \"80%\",\n    borderRadius: 10\n  }\n});\n"]},"metadata":{},"sourceType":"module"}